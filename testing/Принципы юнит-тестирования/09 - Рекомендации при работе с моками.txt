- Проверяйте взаимодействия с неуправляемыми зависимостями на самых границах вашей системы. Мокируйте последний тип в
цепочке типов между кон- троллером и неуправляемой зависимостью. Это поможет улучшить как защиту от багов
(ввиду того что интеграционные тесты проверяют больший объем кода), так и устойчивость к рефакторингу
(так как мок отделяется от подробностей реализации кода).

- Шпионы представляют собой моки, написанные вручную. Для классов, находящихся на границах системы, шпионы предпочтительнее моков.
Они способствуют переиспользованию кода проверок, что приводит к сокращению размера теста и улучшению читаемости.

- Не полагайтесь на рабочий код в тестовых проверках. Используйте отдельный набор литералов и констант в тестах.
Если потребуется, скопируйте эти литералы и константы из рабочего кода. Тесты должны предоставить контрольную точку,
которая не зависит от рабочего кода. В противном случае появляется риск соз- дания тавтологических тестов
(тестов, которые ничего не проверяют и содержат семантически бессмысленные проверки).

- Не все неуправляемые зависимости требуют одинакового уровня обратной совместимости. Если точная структура сообщения не
важна и вы хотите только проверить факт существования сообщения и хранящейся в нем информации, вы можете игнорировать
рекомендацию по проверке взаимодействий с неуправ- ляемыми зависимостями на границах вашей системы. Типичный пример такого
рода — логирование.

- Так как моки предназначены только для неуправляемых зависимостей, а контроллеры должны быть единственной частью кода,
работающей с такими зависимостями, моки должны применяться только при тестировании контроллеров — в интеграционных тестах.
Не используйте моки в юнит-тестах.

- Количество моков, используемых в тесте, несущественно. Оно зависит исключительно от количества неуправляемых
зависимостей, участвующих в операции.

- Проверяйте как существование ожидаемых, так и отсутствие неожиданных обращений к мокам.

- Используйте моки только с принадлежащими вам типами. Напишите для сторонних библиотек собственные адаптеры,
предоставляющие доступ к неуправляемым зависимостям. Мокируйте эти адаптеры вместо нижележащих типов.